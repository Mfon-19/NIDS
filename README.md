# Network Intrusion Detection using Random Forest

The main goal of this project is anomaly detection. We load network traffic data and use a trained Random Forest model to predict which portion of the traffic represents attacks.

## Installation

1.  **Clone the repository:**
    ```bash
    git clone https://github.com/Mfon-19/NIDS.git
    cd NIDS
    ```
2.  **Train the Model:**
    Before running predictions, you need to ensure the model files are generated or up-to-date by running the training script:
    ```bash
    python RandomForestClassifier.py
    ```
    This will process the data and save the necessary model files (`random_forest_model.joblib`, `label_encoder.joblib`, `scaler.joblib`) into the `trained_model_files` folder.

## Project Files

### Root Directory:

* `RandomForestClassifier.py`: Contains the code for training the Random Forest model using the provided CSV files.
* `normal_prediction.py`: Contains the code for loading the trained model and using it to predict labels for normal network flows.
* `attack_prediction.py`: Contains the code for loading the trained model and using it to predict labels for network attack flows.
* `network_normal_flow.csv`: Contains normal network traffic captured on a local machine using CICFlowMeter.
* `sample_attacks.csv`: Contains sample attack traffic collected from the public CIC-IDS2017 dataset.

### `trained_model_files` Directory:

*(These files are generated by `RandomForestClassifier.py`)*

* `label_encoder.joblib`: Contains the saved LabelEncoder object, mapping numeric class values back to their original labels (e.g., 'BENIGN', 'ATTACK TYPE') for interpreting model predictions.
* `random_forest_model.joblib`: Contains the saved, trained Random Forest classifier object used for network intrusion detection.
* `scaler.joblib`: Stores the saved, fitted StandardScaler object used to normalize input features before feeding them into the model for prediction.

## Running Predictions

After training the model (running `RandomForestClassifier.py`), you can use the prediction scripts. For the purpose of being overly explicit, predicting normal traffic and attack traffic are separated.

* **To predict on the provided normal traffic:**
    This script loads `network_normal_flow.csv`, applies the necessary preprocessing using the saved scaler, and predicts labels using the trained model.
    ```bash
    python normal_prediction.py
    ```

* **To predict on the provided attack traffic:**
    This script loads `sample_attacks.csv`, applies the necessary preprocessing using the saved scaler, and predicts labels using the trained model.
    ```bash
    python attack_prediction.py
    ```

## Using Your Own Network Data

The provided `network_normal_flow.csv` was captured using CICFlowMeter. If you want to capture and analyze traffic from your own device:

1.  **Install and Run CICFlowMeter:**
    * Clone the CICFlowMeter repository and follow their instructions to run the software: ðŸ‘‰ [https://github.com/CanadianInstituteForCybersecurity/CICFlowMeter](https://github.com/CanadianInstituteForCybersecurity/CICFlowMeter)
    * Use CICFlowMeter to capture traffic on your network interface and save it as a CSV file.

2.  **Update the Script Path:**
    * Modify the following line in `normal_prediction.py` (or `attack_prediction.py` if analyzing captured attacks) to point to your newly generated CSV file:
        ```python
        # Point this path to your captured traffic CSV file
        new_data_csv = r"path/to/your/captured_traffic.csv"
        ```
       *(Replace `"path/to/your/captured_traffic.csv"` with the actual file path)*

3.  **Run Prediction:**
    Execute the appropriate prediction script:
    ```bash
    python normal_prediction.py
    ```
    *(Or `python attack_prediction.py` if you are analyzing potential attack traffic)*

---

That's all!
