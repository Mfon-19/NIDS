# Network Intrusion Detection using Random Forest

The main goal of this project is anomaly detection. We load network traffic data and use a trained Random Forest model to predict which portion of the traffic represents attacks.

## Installation

1.  **Clone the repository:**
    ```bash
    git clone https://github.com/Mfon-19/NIDS.git
    cd NIDS
    ```
2.  **Train the Model:**
    Before running predictions, you need to ensure the model files are generated or up-to-date by running the training script:
    ```bash
    python RandomForestClassifier.py
    ```
    This will process the data and save the necessary model files (`random_forest_model.joblib`, `label_encoder.joblib`, `scaler.joblib`) into the `trained_model_files` folder.

## Project Files

### Root Directory:

- `RandomForestClassifier.py`: Contains the code for training the Random Forest model using the provided CSV files.
- `predict.py`: Contains the code for loading the trained model and using it to predict labels for network traffic flows.
- `network_normal_flow.csv`: Contains normal network traffic captured on a local machine using CICFlowMeter.
- `sample_attacks.csv`: Contains sample attack traffic collected from the public CIC-IDS2017 dataset.

### `trained_model_files` Directory:

_(These files are generated by `RandomForestClassifier.py`)_

- `label_encoder.joblib`: Contains the saved LabelEncoder object, mapping numeric class values back to their original labels (e.g., 'BENIGN', 'ATTACK TYPE') for interpreting model predictions.
- `random_forest_model.joblib`: Contains the saved, trained Random Forest classifier object used for network intrusion detection.
- `scaler.joblib`: Stores the saved, fitted StandardScaler object used to normalize input features before feeding them into the model for prediction.

## Running Predictions

After training the model (running `RandomForestClassifier.py`), you can use the `predict.py` script to analyze a network traffic CSV file.

The script takes one command-line argument: the path to the CSV file you want to analyze.

- **To predict on the provided normal traffic:**

  ```bash
  python predict.py network_normal_flow.csv
  ```

- **To predict on the provided attack traffic:**
  ```bash
  python predict.py sampled_attacks.csv
  ```

## Using Your Own Network Data

The provided `network_normal_flow.csv` was captured using CICFlowMeter. If you want to capture and analyze traffic from your own device:

1.  **Install and Run CICFlowMeter:**

    - Clone the CICFlowMeter repository and follow their instructions to run the software: ðŸ‘‰ [https://github.com/CanadianInstituteForCybersecurity/CICFlowMeter](https://github.com/CanadianInstituteForCybersecurity/CICFlowMeter)
    - Use CICFlowMeter to capture traffic on your network interface and save it as a CSV file.

2.  **Run Prediction:**
    Execute the prediction script with the path to your file:
    ```bash
    python predict.py path/to/your/captured_traffic.csv
    ```
    _(Replace `"path/to/your/captured_traffic.csv"` with the actual file path)_

---

That's all!
